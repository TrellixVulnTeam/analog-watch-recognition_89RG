schema: '2.0'
stages:
  download-images:
    cmd: python scripts/download-images.py datasets/watch-faces.json
    deps:
    - path: datasets/watch-faces.json
      md5: c1cea609c66b53edfdd07e8ae28f9fe4
      size: 218288
    - path: scripts/download-images.py
      md5: 163a2ddbebf57d03fc4ac6640fff005b
      size: 1804
    outs:
    - path: datasets/test
      md5: c316cc0b182e5924a1f5bb8820cd87b8.dir
      size: 6465792
      nfiles: 2
    - path: datasets/train
      md5: 14c2aeb4a00a4b2141c061e50e2c209f.dir
      size: 40396693
      nfiles: 46
    - path: datasets/val
      md5: 33ab1562f9438476fdb1c2ece65a2720.dir
      size: 3021825
      nfiles: 5
    - path: datasets/watch-faces-local.json
      md5: 679afb6a09b1c87f2243532ba1d6f550
      size: 217069
  train-detector:
    cmd: python watch_recognition/watch_recognition/train/object_detection_task.py  --epochs
      50  --batch-size 4  --confidence-threshold 0.5  --seed 42
    deps:
    - path: datasets/test
      md5: c316cc0b182e5924a1f5bb8820cd87b8.dir
      size: 6465792
      nfiles: 2
    - path: datasets/train
      md5: 14c2aeb4a00a4b2141c061e50e2c209f.dir
      size: 40396693
      nfiles: 46
    - path: datasets/val
      md5: 33ab1562f9438476fdb1c2ece65a2720.dir
      size: 3021825
      nfiles: 5
    - path: datasets/watch-faces-local.json
      md5: 679afb6a09b1c87f2243532ba1d6f550
      size: 217069
    - path: watch_recognition/watch_recognition/train/object_detection_task.py
      md5: c1abde53cbba80b698b7cf8ea4b356b4
      size: 32415
    params:
      params.yaml:
        detector.batch-size: 4
        detector.epochs: 50
        seed: 42
    outs:
    - path: example_predictions/detector/test-image.jpg
      md5: 1e0665f509a2f8259731be535a3377f6
      size: 128072
    - path: metrics/detector.json
      md5: 9e17dbceb89ad9d425cd285811fa2ba1
      size: 133
    - path: metrics/detector/scalars
      md5: aad3d742ef1dd66a0b921e0a412d7cf4.dir
      size: 3763
      nfiles: 2
    - path: models/detector/
      md5: 8c9f316cc50d48da9c65e3c99600abcc.dir
      size: 153528239
      nfiles: 4
  eval-detector:
    cmd: python watch_recognition/watch_recognition/eval/object_detection_eval.py
    deps:
    - path: models/detector/
      md5: 8c9f316cc50d48da9c65e3c99600abcc.dir
      size: 153528239
      nfiles: 4
    - path: watch_recognition/watch_recognition/eval/object_detection_eval.py
      md5: 080fe3096a2ec1867cd3f79e1e2fa8ee
      size: 5723
    outs:
    - path: example_predictions/detector/train_0.jpg
      md5: ff35d32a68479523527c878d315d0ca0
      size: 103672
    - path: example_predictions/detector/train_1.jpg
      md5: bcf81a7916cd2229aa007aa7659e8aa6
      size: 157518
    - path: example_predictions/detector/train_2.jpg
      md5: b7bc3f27ffd755e005e21154a22ccadb
      size: 83365
    - path: example_predictions/detector/train_3.jpg
      md5: 281822dfb5245cac2b5d3597f6a9a6fd
      size: 121804
    - path: example_predictions/detector/train_4.jpg
      md5: e1cb7317a2627aa40eac1d887d9719ef
      size: 52504
    - path: example_predictions/detector/val_0.jpg
      md5: a60b2d06bbc6919e2a4b8c13e93a0b2d
      size: 133049
    - path: example_predictions/detector/val_1.jpg
      md5: b336ca8223e3547610f6b63f7e8713ef
      size: 201856
    - path: example_predictions/detector/val_2.jpg
      md5: f8401cbefad16ae3d12a51ad89fb59ec
      size: 111927
    - path: example_predictions/detector/val_3.jpg
      md5: 50562051aa6b879b9981bacc5ed342a1
      size: 208201
    - path: metrics/detector/PR-IoU@0.50_train.tsv
      md5: d3196f21e47a77724bec0b8293e1e81d
      size: 1059
    - path: metrics/detector/PR-IoU@0.50_val.tsv
      md5: d3196f21e47a77724bec0b8293e1e81d
      size: 1059
    - path: metrics/detector/PR-IoU@0.75_train.tsv
      md5: e72616c11f7c547870f2e47af4544b23
      size: 2379
    - path: metrics/detector/PR-IoU@0.75_val.tsv
      md5: c905c8756f6967cbbce756b293b68ec2
      size: 1059
    - path: metrics/detector/PR-IoU@0.95_train.tsv
      md5: 5a31a4c962871aa8a6c0672ea69be04f
      size: 1141
    - path: metrics/detector/PR-IoU@0.95_val.tsv
      md5: eb9c22f401e52e662cc9020d738478e0
      size: 1059
    - path: metrics/detector/coco_train.json
      md5: fd7b4c67a8111e8d6cf33d8a8cdea4af
      size: 270
    - path: metrics/detector/coco_val.json
      md5: 8c6f181fcc2fa716da55d5a5c5f5abb6
      size: 226
  update-metrics:
    cmd: python scripts/update-metrics-table-and-graph.py
    deps:
    - path: metrics
      md5: 9d5cc687e8d538d0f068f9b3474e1232.dir
      size: 89808
      nfiles: 20
  train-keypoint:
    cmd: python watch_recognition/watch_recognition/train/heatmap_regression_task.py
      --epochs 50 --batch-size 8 --confidence-threshold 0.5 --seed 42
    deps:
    - path: datasets/test
      md5: c316cc0b182e5924a1f5bb8820cd87b8.dir
      size: 6465792
      nfiles: 2
    - path: datasets/train
      md5: 14c2aeb4a00a4b2141c061e50e2c209f.dir
      size: 40396693
      nfiles: 46
    - path: datasets/val
      md5: 33ab1562f9438476fdb1c2ece65a2720.dir
      size: 3021825
      nfiles: 5
    - path: datasets/watch-faces-local.json
      md5: 679afb6a09b1c87f2243532ba1d6f550
      size: 217069
    - path: watch_recognition/watch_recognition/train/heatmap_regression_task.py
      md5: 6fa3094a5b4ec5f84c96d8d2920617ae
      size: 5531
    params:
      params.yaml:
        keypoint:
          epochs: 50
          batch-size: 8
          confidence-threshold: 0.5
        seed: 42
    outs:
    - path: example_predictions/keypoint/test-image-2.jpg
      md5: 12acfac6805b33bac8a45ebedb4bc7b8
      size: 53784
    - path: metrics/keypoint.json
      md5: c17c2360beb6242942913f30622ec477
      size: 214
    - path: metrics/keypoint/scalars/
      md5: 4e7288cf10ee0249727f36603151b576.dir
      size: 7527
      nfiles: 4
    - path: models/keypoint/
      md5: e5ad8262e9f5cc66e4003c3d2de8614c.dir
      size: 164739511
      nfiles: 8
  eval-keypoint:
    cmd: python watch_recognition/watch_recognition/eval/keypoint_detection_eval.py
    deps:
    - path: models/detector/
      md5: 8c9f316cc50d48da9c65e3c99600abcc.dir
      size: 153528239
      nfiles: 4
    - path: models/keypoint/
      md5: e5ad8262e9f5cc66e4003c3d2de8614c.dir
      size: 164739511
      nfiles: 8
    - path: watch_recognition/watch_recognition/eval/keypoint_detection_eval.py
      md5: 8f56522b9e82407eccd3941738164708
      size: 6106
    outs:
    - path: example_predictions/keypoint/train_0.jpg
      md5: d92f5f84c2d0d9c4ae49ed41c9e66433
      size: 45009
    - path: example_predictions/keypoint/train_1.jpg
      md5: f14020cadf2cb4d4bf0da22f8c7c26a3
      size: 36400
    - path: example_predictions/keypoint/train_2.jpg
      md5: 2876981dbe9280e1cfc2760f034165c9
      size: 40077
    - path: example_predictions/keypoint/train_3.jpg
      md5: 361f26f1026207edad632ea5cb4b0da4
      size: 50576
    - path: example_predictions/keypoint/train_4.jpg
      md5: 14a866ac0cb25e9d23f2c3313c1c39a3
      size: 48255
    - path: example_predictions/keypoint/val_0.jpg
      md5: 17b51101f1624f0ee07dcca4cfbbe17f
      size: 50845
    - path: example_predictions/keypoint/val_1.jpg
      md5: e02619510cac67eccb976c384353d085
      size: 57405
    - path: example_predictions/keypoint/val_2.jpg
      md5: e02cef89feb81e028143cbfd72f68732
      size: 48132
    - path: example_predictions/keypoint/val_3.jpg
      md5: 7dba4d1f35ba04b62d7216e804c04023
      size: 60557
    - path: example_predictions/keypoint/val_4.jpg
      md5: 4c9c5b6e6b596307bf9e6d61134629e1
      size: 53349
    - path: metrics/keypoint/coco_train.json
      md5: 6df2a283628b99937645a6afb5dcb5ad
      size: 258
    - path: metrics/keypoint/coco_val.json
      md5: f6a313c31bb1b251db418aeb77de540b
      size: 216
