schema: '2.0'
stages:
  download-images:
    cmd: python scripts/download-images.py datasets/watch-faces.json
    deps:
    - path: datasets/watch-faces.json
      md5: 1d03123e19b5fcdcb9ee6f452e3869f7
      size: 146322
    - path: scripts/download-images.py
      md5: 163a2ddbebf57d03fc4ac6640fff005b
      size: 1804
    outs:
    - path: datasets/test
      md5: c316cc0b182e5924a1f5bb8820cd87b8.dir
      size: 6465792
      nfiles: 2
    - path: datasets/train
      md5: 30e90e50ccb58663b4630a6b353c7227.dir
      size: 24166019
      nfiles: 36
    - path: datasets/val
      md5: 925b466cd67b6fd4351e4107217ce7d0.dir
      size: 511575
      nfiles: 4
    - path: datasets/watch-faces-local.json
      md5: e197c9b76435b67de879087d46b35d29
      size: 145494
  train-detector:
    cmd: python watch_recognition/watch_recognition/train/object_detection_task.py  --epochs
      100  --batch-size 4  --confidence-threshold 0.5  --seed 42
    deps:
    - path: datasets/test
      md5: c316cc0b182e5924a1f5bb8820cd87b8.dir
      size: 6465792
      nfiles: 2
    - path: datasets/train
      md5: 30e90e50ccb58663b4630a6b353c7227.dir
      size: 24166019
      nfiles: 36
    - path: datasets/val
      md5: 925b466cd67b6fd4351e4107217ce7d0.dir
      size: 511575
      nfiles: 4
    - path: datasets/watch-faces-local.json
      md5: e197c9b76435b67de879087d46b35d29
      size: 145494
    - path: watch_recognition/watch_recognition/train/object_detection_task.py
      md5: c1abde53cbba80b698b7cf8ea4b356b4
      size: 32415
    params:
      params.yaml:
        detector.batch-size: 4
        detector.epochs: 100
        seed: 42
    outs:
    - path: example_predictions/detector/test-image.jpg
      md5: 62a8deeac5602b939be254a3446e1d04
      size: 129210
    - path: metrics/detector.json
      md5: ee0e2d945a4a0c55ea42d7c0b41e7922
      size: 133
    - path: metrics/detector/scalars
      md5: 4db6d2225bd43d082fdf1f85aa14abec.dir
      size: 7480
      nfiles: 2
    - path: models/detector/
      md5: 025b65ecb2aa6d0e903e453c32083bd7.dir
      size: 153528239
      nfiles: 4
  eval-detector:
    cmd: python watch_recognition/watch_recognition/eval/object_detection_eval.py
    deps:
    - path: models/detector/
      md5: 025b65ecb2aa6d0e903e453c32083bd7.dir
      size: 153528239
      nfiles: 4
    - path: watch_recognition/watch_recognition/eval/object_detection_eval.py
      md5: ffd509a84f371198f0a5ba4ec025f557
      size: 5696
    outs:
    - path: example_predictions/detector/train_0.jpg
      md5: 994cf445ad2d664cc2e1267b7766d3f2
      size: 157515
    - path: example_predictions/detector/train_1.jpg
      md5: bdf08fa0463e676a51a3904dafb1128e
      size: 177719
    - path: example_predictions/detector/train_2.jpg
      md5: a5c270466f20317723b095d42fa7a18a
      size: 176776
    - path: example_predictions/detector/train_3.jpg
      md5: ad7175a17099b9fbde747e5cb6bb75cb
      size: 74864
    - path: example_predictions/detector/train_4.jpg
      md5: ebbd59f0a4b20d6bb2894dd605102992
      size: 132982
    - path: example_predictions/detector/val_0.jpg
      md5: ede50ceced56fcc02059265cd22b5b58
      size: 201247
    - path: example_predictions/detector/val_1.jpg
      md5: 0354a50cf1b2be781fed953ed399b6c1
      size: 115020
    - path: example_predictions/detector/val_2.jpg
      md5: 09c968e59021a3a4f1e16f93320eb305
      size: 208856
    - path: example_predictions/detector/val_3.jpg
      md5: 8661c331151a080bf40ae6d07e078367
      size: 63388
    - path: metrics/detector/PR-IoU@0.50_train.tsv
      md5: d3196f21e47a77724bec0b8293e1e81d
      size: 1059
    - path: metrics/detector/PR-IoU@0.50_val.tsv
      md5: d3196f21e47a77724bec0b8293e1e81d
      size: 1059
    - path: metrics/detector/PR-IoU@0.75_train.tsv
      md5: 157e83a725ac178b5cd4f78f8b27b745
      size: 1824
    - path: metrics/detector/PR-IoU@0.75_val.tsv
      md5: d3196f21e47a77724bec0b8293e1e81d
      size: 1059
    - path: metrics/detector/PR-IoU@0.95_train.tsv
      md5: f067141b72653814a7b1498894077c04
      size: 1256
    - path: metrics/detector/PR-IoU@0.95_val.tsv
      md5: 6a8755bb0078042205da94e8fcd04e2d
      size: 1449
    - path: metrics/detector/coco_train.json
      md5: e07d15c9e09e4555ddbea987e90e6d0a
      size: 246
    - path: metrics/detector/coco_val.json
      md5: 69af15524739cbba2bbd3a0c8ca2edc1
      size: 191
  update-metrics:
    cmd: python scripts/update-metrics-table.py
    deps:
    - path: metrics
      md5: cc2c26ee5f8fcbd03ec8b806878592f6.dir
      size: 54620
      nfiles: 14
