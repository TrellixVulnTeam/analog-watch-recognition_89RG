schema: '2.0'
stages:
  download-images:
    cmd: python scripts/download-images.py datasets/watch-faces.json --concurrent
    deps:
    - path: datasets/watch-faces.json
      md5: e00b9915f01e7e120532a6d54a61c252
      size: 585871
    - path: scripts/download-images.py
      md5: a037cfab1a482a356f1d7d62804041d3
      size: 3961
    outs:
    - path: datasets/test
      md5: 6904a01888485f56672750554a7bb1e0.dir
      size: 16911707
      nfiles: 46
    - path: datasets/train
      md5: 9a3f5b148227c37600c3af6a9b0b0161.dir
      size: 82169507
      nfiles: 154
    - path: datasets/val
      md5: 8ac3dabbeb73f54d330cb1c0f26e8d62.dir
      size: 17982237
      nfiles: 36
    - path: datasets/watch-faces-local.json
      md5: db7c3dda8302f2f04fc4d627941d0551
      size: 581754
  train-detector:
    cmd: python watch_recognition/watch_recognition/train/object_detection_task.py  --epochs
      60  --batch-size 16  --confidence-threshold 0.5  --seed 42
    deps:
    - path: checkpoints/detector/
      md5: 262b04cceb42d0e7658bf70da75b501e.dir
      size: 436687933
      nfiles: 3
    - path: datasets/test
      md5: 6904a01888485f56672750554a7bb1e0.dir
      size: 16911707
      nfiles: 46
    - path: datasets/train
      md5: 9a3f5b148227c37600c3af6a9b0b0161.dir
      size: 82169507
      nfiles: 154
    - path: datasets/val
      md5: 8ac3dabbeb73f54d330cb1c0f26e8d62.dir
      size: 17982237
      nfiles: 36
    - path: datasets/watch-faces-local.json
      md5: db7c3dda8302f2f04fc4d627941d0551
      size: 581754
    - path: watch_recognition/watch_recognition/train/object_detection_task.py
      md5: 4f2a8f7f6133997316921fba3ea47740
      size: 32743
    params:
      params.yaml:
        detector:
          epochs: 60
          batch-size: 16
          confidence-threshold: 0.5
        seed: 42
    outs:
    - path: example_predictions/detector/test-image.jpg
      md5: 1b781313a38c68e64ebf5942ba6e9ccb
      size: 128246
    - path: metrics/detector.json
      md5: 32d925097b0b980413b21603c28fb299
      size: 133
    - path: metrics/detector/scalars
      md5: cb7e9d00d3d164c899f0b43bda0ef86f.dir
      size: 4526
      nfiles: 2
    - path: models/detector/
      md5: c8ee744e619baf859a79d31740caddad.dir
      size: 155280910
      nfiles: 6
  eval-detector:
    cmd: python watch_recognition/watch_recognition/eval/object_detection_eval.py
    deps:
    - path: models/detector/
      md5: c8ee744e619baf859a79d31740caddad.dir
      size: 155280910
      nfiles: 6
    - path: watch_recognition/watch_recognition/eval/object_detection_eval.py
      md5: 4158239597b8bb9d7d216728e0840605
      size: 6019
    outs:
    - path: example_predictions/detector/train_0.jpg
      md5: d8d67b851d4c8d81d91d161bf11585a7
      size: 205074
    - path: example_predictions/detector/train_1.jpg
      md5: ab7d6559315fbe8c888c8d065060869c
      size: 112026
    - path: example_predictions/detector/train_2.jpg
      md5: 78a10c8bc4cb8569200e9a38bfc014db
      size: 88313
    - path: example_predictions/detector/train_3.jpg
      md5: b4d42d25b19dbfa6a43f71e30fe0f1c4
      size: 136782
    - path: example_predictions/detector/train_4.jpg
      md5: 50cc0d08a00b03976a1162600bc438c9
      size: 84313
    - path: example_predictions/detector/val_0.jpg
      md5: 0845eaa60b0c134f7036890a24c1dd38
      size: 83916
    - path: example_predictions/detector/val_1.jpg
      md5: a2a766c33a42b35ddbe11415c974624d
      size: 133439
    - path: example_predictions/detector/val_2.jpg
      md5: f0f71a7c454131219047e7b0cf43a6ff
      size: 208765
    - path: example_predictions/detector/val_3.jpg
      md5: a8871407117a3783c75fb1547f3949a6
      size: 112469
    - path: metrics/detector/PR-IoU@0.50_train.tsv
      md5: 702197ac5de726ccdc454d44f2f5d462
      size: 1645
    - path: metrics/detector/PR-IoU@0.50_val.tsv
      md5: d3196f21e47a77724bec0b8293e1e81d
      size: 1059
    - path: metrics/detector/PR-IoU@0.75_train.tsv
      md5: 6373acad9da1600dd83cb416b46963ed
      size: 1529
    - path: metrics/detector/PR-IoU@0.75_val.tsv
      md5: 8a736d531c589c40648e33d01a87fd0a
      size: 1059
    - path: metrics/detector/PR-IoU@0.95_train.tsv
      md5: 38ee6e041e664a475efa27e6ecfe881b
      size: 1138
    - path: metrics/detector/PR-IoU@0.95_val.tsv
      md5: eb9c22f401e52e662cc9020d738478e0
      size: 1059
    - path: metrics/detector/coco_train.json
      md5: 12e41f1408c0a1130923c1a48f0269a2
      size: 287
    - path: metrics/detector/coco_val.json
      md5: a8fd584f0ff491ced72943d6ddc01648
      size: 227
  update-metrics:
    cmd: python scripts/update-metrics-table-and-graph.py
    deps:
    - path: metrics
      md5: f9487ab092c4acc02321245bec74e596.dir
      size: 230176
      nfiles: 36
  train-keypoint:
    cmd: python watch_recognition/watch_recognition/train/heatmap_regression_task.py
      --epochs 60 --batch-size 16 --confidence-threshold 0.5 --seed 42
    deps:
    - path: checkpoints/keypoint/
      md5: b6b6c41924818a0ded96ab69a2bd4e0e.dir
      size: 84348803
      nfiles: 3
    - path: datasets/test
      md5: 6904a01888485f56672750554a7bb1e0.dir
      size: 16911707
      nfiles: 46
    - path: datasets/train
      md5: 9a3f5b148227c37600c3af6a9b0b0161.dir
      size: 82169507
      nfiles: 154
    - path: datasets/val
      md5: 8ac3dabbeb73f54d330cb1c0f26e8d62.dir
      size: 17982237
      nfiles: 36
    - path: datasets/watch-faces-local.json
      md5: db7c3dda8302f2f04fc4d627941d0551
      size: 581754
    - path: watch_recognition/watch_recognition/train/heatmap_regression_task.py
      md5: 16c5e2bb4360922c2ec1397ea8295d8b
      size: 7053
    params:
      params.yaml:
        keypoint:
          epochs: 60
          batch-size: 16
          confidence-threshold: 0.5
        seed: 42
    outs:
    - path: example_predictions/keypoint/test-image-2.jpg
      md5: 564e1a6775eed2b9bacd31e675fd376b
      size: 66357
    - path: metrics/keypoint.json
      md5: 19a0e88974d70158a695611e4503e3d7
      size: 214
    - path: metrics/keypoint/scalars/
      md5: 04c0a1746b2982fb2c20aa469fd05a6c.dir
      size: 9017
      nfiles: 4
    - path: models/keypoint/
      md5: 3d14403bb1c0811c028e3ba8da69b497.dir
      size: 36542592
      nfiles: 6
  eval-keypoint:
    cmd: python watch_recognition/watch_recognition/eval/keypoint_detection_eval.py
      --kp-confidence-threshold 0.5
    deps:
    - path: models/detector/
      md5: c8ee744e619baf859a79d31740caddad.dir
      size: 155280910
      nfiles: 6
    - path: models/keypoint/
      md5: 3d14403bb1c0811c028e3ba8da69b497.dir
      size: 36542592
      nfiles: 6
    - path: watch_recognition/watch_recognition/eval/keypoint_detection_eval.py
      md5: 3b25b23a8c308884c58b6d5ac4261f0d
      size: 6263
    outs:
    - path: example_predictions/keypoint/train_0.jpg
      md5: 1b8772499ebdd68759c7ac61e4c00e47
      size: 73556
    - path: example_predictions/keypoint/train_1.jpg
      md5: 14ca1d24b41933fca528abe8556fb117
      size: 51105
    - path: example_predictions/keypoint/train_2.jpg
      md5: 80ce0e75fe204693e32a155278651020
      size: 59948
    - path: example_predictions/keypoint/train_3.jpg
      md5: df6ccb4cc4389490f0479aaa891c5d78
      size: 27421
    - path: example_predictions/keypoint/train_4.jpg
      md5: c6759ec50d82cdb745ca2828f45f2b30
      size: 39618
    - path: example_predictions/keypoint/val_0.jpg
      md5: db027d009b2afc6c0f6e5b41f3416862
      size: 57130
    - path: example_predictions/keypoint/val_1.jpg
      md5: 52661ced7cd97008cff5f2a0e5c01fe9
      size: 61464
    - path: example_predictions/keypoint/val_2.jpg
      md5: 5e557a9e86dfc35f92274b5edae23711
      size: 70518
    - path: example_predictions/keypoint/val_3.jpg
      md5: 87832b619f8c3fb35f9b3b50d043298b
      size: 59136
    - path: example_predictions/keypoint/val_4.jpg
      md5: 64fb4522506c6f0a84ab77483c30b0da
      size: 73841
    - path: metrics/keypoint/coco_train.json
      md5: d82394295b6ce887e8934cd194dcc43c
      size: 247
    - path: metrics/keypoint/coco_val.json
      md5: a84d911708ca1ded41eb63f57f50ec7e
      size: 229
  train-segmentation:
    cmd: python watch_recognition/watch_recognition/train/segmentation_task.py --epochs
      60 --batch-size 16 --confidence-threshold 0.5 --seed 42
    deps:
    - path: checkpoints/segmentation/
      md5: d134c67fc7120cbc56ab396262ad8856.dir
      size: 84321131
      nfiles: 3
    - path: datasets/test
      md5: 6904a01888485f56672750554a7bb1e0.dir
      size: 16911707
      nfiles: 46
    - path: datasets/train
      md5: 9a3f5b148227c37600c3af6a9b0b0161.dir
      size: 82169507
      nfiles: 154
    - path: datasets/val
      md5: 8ac3dabbeb73f54d330cb1c0f26e8d62.dir
      size: 17982237
      nfiles: 36
    - path: datasets/watch-faces-local.json
      md5: db7c3dda8302f2f04fc4d627941d0551
      size: 581754
    - path: watch_recognition/watch_recognition/train/segmentation_task.py
      md5: 31611ed07c4dec05d217e9b9c4e2084a
      size: 7436
    params:
      params.yaml:
        seed: 42
        segmentation:
          epochs: 60
          batch-size: 16
          confidence-threshold: 0.5
    outs:
    - path: example_predictions/segmentation/test-image-2.jpg
      md5: f988efa732ca032f9e03947aaae12556
      size: 58746
    - path: metrics/segmentation.json
      md5: f4a908be2b568aef219607db3754696d
      size: 215
    - path: metrics/segmentation/scalars/
      md5: ccacd4d83ec3f4c60bd3db7bd8434e33.dir
      size: 9029
      nfiles: 4
    - path: models/segmentation/
      md5: 3c12c44389ed179e56428f1ef23564cc.dir
      size: 36518038
      nfiles: 5
